<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title>Lottery front-end</title>
    <link rel="stylesheet" type="text/css" href="cssIndex.css" />
    <script language="javascript" type="text/javascript" src="jquery.min.js"></script>
    <script language="javascript" type="text/javascript" src="web3.js"></script>
    <script language="javascript" type="text/javascript" src="main_abi.js"></script>

    <script language="javascript" type="text/javascript" src="js/utils.js"></script>
    <script language="javascript" type="text/javascript" src="js/commonControls.js"></script>
    <script language="javascript" type="text/javascript" src="js/userControls.js"></script>
    <script language="javascript" type="text/javascript" src="js/ownerControls.js"></script>
  </head>
  <body onload="checkMetamaskAndStart()">

    <div class="title">
      Game status:
    </div>
    <table>
      <tr>
        <td class="firstCollumn">Game status:</td>
        <td>
          <div id="txStatus">Not connected to contract</div>
        </td>
      </tr>
      <tr>
        <td class="firstCollumn">Game start time:</td>
        <td>
          <div id="txTimestamp"></div>
        </td>
      </tr>
      <tr>
        <td class="firstCollumn">Hash of chosen number:</td>
        <td>
          <div id="txWinningNumberHash"></div>
        </td>
      </tr>
      <tr>
        <td class="firstCollumn">Your last action:</td>
        <td>
          <div id="txLastAction"></div>
        </td>
      </tr>
      <tr>
        <td class="firstCollumn">Time until betting end:</td>
        <td>
          <div id="txTimeoutBetting"></div>
        </td>
      </tr>
      <tr class="winnerRevealed">
        <td class="firstCollumn">Chosen number:</td>
        <td>
          <div id="revealedNumber"></div>
        </td>
      </tr>
      <tr class="winnerRevealed">
        <td class="firstCollumn">Time until end of claims:</td>
        <td>
          <div id="revealedNumber"></div>
        </td>
      </tr>
    </table>

    <div id="userControls">
      <div class="title">
        User controls
      </div>
      <table>
        <tr>
          <td class="firstCollumn">Place bet with hash</td>
          <td> <input class="wideInput" type="text" name="placeBetInput" id="placeBetInput"><br> </td>
          <td> <button class="button" onclick="placeBet()">Place bet</button> </td>
          <td>  <div class="help-tip">
                  <p>A bet is worth 1 ether. Contract status should be "Accepting bets". Generate your hash as described below.</p>
                </div>
          </td>
        </tr>
        <tr>
          <td class="firstCollumn">Claim bet</td>
          <td> <input class="wideInput" type="text" name="claimBet" id="claimBet"><br> </td>
          <td> <button class="button" onclick="claimBet()">Claim bet</button> </td>
          <td>  <div class="help-tip">
                  <p>Claim your bet by specifying the original seed.number combination you hashed. Contract status should be "Accepting claims". </p>
                </div>
          </td>
        </tr>
      </table>
    </div>
    <div id="adminControls">
      <div class="title">
        Admin controls
      </div>
      <table>
          <tr>
            <td class="firstCollumn">Restart contract</td>
            <td> <input type="text" name="resetInputHash" id="resetInput"><br> </td>
            <td> <input type="text" name="resetInputTimeoutBetting" id="resetInputTimeoutBetting"><br> </td>
            <td> <input type="text" name="resetInputTimeoutClaiming" id="resetInputTimeoutClaiming"><br> </td>
            <td> <button class="button" onclick="reset()">Restart</button> </td>
            <td>  <div class="help-tip">
                    <p>To be executed by the contract owner only. Start a new round of the game by choosing a new secret number. Generate your has as described below. </p>
                  </div>
            </td>
          </tr>
          <tr>
            <td class="firstCollumn">Reveal winning number</td>
            <td> <input class="wideInput" type="text" name="revealWinning" id="revealWinning"><br> </td>
            <td> <button class="button" onclick="revealNumber()">Reveal</button> </td>
            <td>  <div class="help-tip">
                    <p>To be executed by the contract owner only. Reveal the secret number by specifying the original seed.number combination you hashed. </p>
                  </div>
            </td>
          </tr>
          <tr>
            <td class="firstCollumn">Award winner</td>
            <td></td>
            <td> <button class="button" onclick="awardWinner()">Award winner</button> </td>
            <td>  <div class="help-tip">
                    <p>To be executed by the contract owner only. Stop accepting claims and reward the owner of the bet which is closest to the secret number. </p>
                  </div>
            </td>
          </tr>
      </table>
    </div>

    <div class="winnerRevealed">
      <div id="winnerTitle" class="title"> Current winner </div>
      <table class="centeredTable">
          <tr class="tableTitle">
            <td class="halfWidth">Address of participant </td>
            <td class="halfWidth">Difference</td>
          </tr>
          <tr>
            <td id="txCurrentWinner"> <p/> </td>
            <td id="txCurrentDifference"> <p/> </td>
          </tr>
      </table>
    </div>

    <div class="title">
      Received bets
    </div>
    <table class="centeredTable" id="betsTable">
        <tr class="tableTitle">
          <td class="halfWidth">Address of participant </td>
          <td class="halfWidth">Hash of bet </td>
        </tr>
    </table>

  </body>
</html>
